@import url('https://fonts.googleapis.com/css2?family=Source+Serif+4:opsz,wght@8..60,400;8..60,600;8..60,700&display=swap');

:root{
  --maxw: 1080px;
  --serif: 'Source Serif 4', 'Times New Roman', Times, serif;
  --lh: 1.7;
  --fs: 17px;

  /* semantic hues */
  --theorem: #2f5da9;
  --lemma:   #5b6b7f;
  --cor:     #b13b3b;
  --def:     #2f8f6b;
  --rem:     #5b6b7f;

  --ink: #0b1220;
  --muted: #4b5563;
  --rule: #e5e7eb;
  --soft: #f8fafc;

  --radius: 3px;
  --header-h: 70px;
}

html,body{height:100%}
body{
  margin:0; color:var(--ink); background:#fff;
  font-family:var(--serif); font-size:var(--fs); line-height:var(--lh);
  counter-reset: sec app 0;
}
a{color:var(--theorem); text-decoration:none}
a:hover{text-decoration:underline}
img{max-width:100%; display:block}
mjx-container[display="true"]{margin:12px 0 !important}

/* Sticky header + scroll snap compensation */
.section-title, theorem, lemma, corollary, proposition, definition, remark, equation, figure, table { scroll-margin-top: calc(var(--header-h) + 8px); }

.site-header{
  position: sticky; top: 0; z-index: 40; border-bottom:1px solid var(--rule);
  background:#fff linear-gradient(90deg, rgba(47,93,169,.12), rgba(177,59,59,.12));
}
.header-inner{
  max-width:var(--maxw); margin:0 auto; padding:12px 20px;
  min-height: var(--header-h); display:flex; align-items:center; justify-content:space-between
}
.brand{font-weight:700; letter-spacing:.2px}
.brand small{color:var(--muted); font-weight:600; margin-left:.5rem}

main{max-width:var(--maxw); margin:0 auto; padding: calc(var(--header-h) + 12px) 20px 28px;}

h1.title{font-weight:700; font-size:32px; line-height:1.25; margin:0 0 8px}
.authors{color:var(--muted); margin-bottom:16px}

.abstract,.callout{
  position:relative; padding:14px 16px; border:1px solid var(--rule);
  border-radius: var(--radius); background: var(--soft); margin:18px 0
}
.abstract .label{display:inline-block; font-style:italic; font-weight:700; color:var(--muted); margin-bottom:6px}
.abstract p,.callout p{margin:8px 0}

/* ---------------- Sections & Appendix counters ---------------- */
section.sec{counter-reset: subsec thm def rem eq fig tab}
section.appendix{counter-reset: subsec thm def rem eq fig tab}

section.sec > .section-title{
  font-size:24px; font-weight:700; margin:32px 0 12px; color: var(--ink);
  counter-increment: sec; /* keep eq numbering tied to section even if JS labels text */
}
/* Fallback numbering (no-JS): insert number text via ::before */
section.sec > .section-title:not([data-labeled])::before{
  content: counter(sec) ". "; font-weight:700; margin-right:2px; color: var(--ink)
}
/* Appendix heading increments a separate counter */
section.appendix > .section-title{ counter-increment: app; }
section.appendix > .section-title:not([data-labeled])::before{
  content: "Appendix " counter(app, upper-alpha) ". "; font-weight:700; margin-right:2px; color: var(--ink)
}

section.subsec > .section-title{
  font-size:21px; font-weight:700; margin:24px 0 12px; color: var(--ink);
  counter-increment: subsec;
}
section.subsec > .section-title:not([data-labeled])::before{
  content: counter(sec) "." counter(subsec) ". "; font-weight:700; margin-right:2px; color: var(--ink)
}

p{margin:10px 0; text-align:justify}
hr.sep{border:none; border-top:1px solid var(--rule); margin:24px 0}

/* ---------------- Counters ---------------- */
.roman-italic { list-style: lower-roman; counter-reset: roman-italic; padding-left: 3.8rem }
.roman-italic li { counter-increment: roman-italic }
.roman-italic li::marker { content: "(" counter(roman-italic, lower-roman) ")    "; font-style: italic }

.decimal { list-style: lower-roman; counter-reset: decimal; padding-left: 2.3rem }
.decimal li { counter-increment: decimal }
.decimal li::marker { content: "(" counter(decimal, decimal) ")  " }

/* ---------------- Equation wrapper ---------------- */
equation{display:block; position:relative; text-align:center; margin:14px 0}
equation[data-align="left"] mjx-container[display="true"]{ text-align: left; margin-left: 1em !important; }
section.sec equation::after{
  counter-increment: eq; content: "(" counter(sec) "." counter(eq) ")";
  position:absolute; right:0; top:50%; transform:translateY(-50%); color:var(--muted)
}
section.appendix equation::after{
  counter-increment: eq; content: "(" counter(app, upper-alpha) "." counter(eq) ")";
  position:absolute; right:0; top:50%; transform:translateY(-50%); color:var(--muted)
}
equation[data-numbered="false"]::after{content:none}

/* ---------------- Enunciations ---------------- */
theorem, lemma, corollary, proposition, definition, remark{
  display:block; margin:18px 0; padding:12px 14px; border:1px solid var(--rule);
  border-left-width:3px; border-radius:var(--radius); background:#fff;
  font-style: normal;
}
theorem{border-left-color:var(--theorem)}
proposition{border-left-color:var(--theorem)}
lemma{border-left-color:var(--lemma)}
corollary{border-left-color:var(--cor)}
definition{border-left-color:var(--def)}
remark{border-left-color:var(--rem)}

/* Fallback labels (no-JS) — only when [data-labeled] 없음 */
section.sec theorem:not([data-labeled])::before,
section.sec lemma:not([data-labeled])::before,
section.sec corollary:not([data-labeled])::before,
section.sec proposition:not([data-labeled])::before{
  counter-increment: thm; display:block; font-weight:600; margin-bottom:6px;
}
section.sec theorem:not([data-labeled])::before{content: "Theorem " counter(sec) "." counter(thm) "."}
section.sec lemma:not([data-labeled])::before{content: "Lemma " counter(sec) "." counter(thm) "."}
section.sec corollary:not([data-labeled])::before{content: "Corollary " counter(sec) "." counter(thm) "."}
section.sec proposition:not([data-labeled])::before{content: "Proposition " counter(sec) "." counter(thm) "."}

section.appendix theorem:not([data-labeled])::before,
section.appendix lemma:not([data-labeled])::before,
section.appendix corollary:not([data-labeled])::before,
section.appendix proposition:not([data-labeled])::before{
  counter-increment: thm; display:block; font-weight:600; margin-bottom:6px;
}
section.appendix theorem:not([data-labeled])::before{content: "Theorem " counter(app, upper-alpha) "." counter(thm) "."}
section.appendix lemma:not([data-labeled])::before{content: "Lemma " counter(app, upper-alpha) "." counter(thm) "."}
section.appendix corollary:not([data-labeled])::before{content: "Corollary " counter(app, upper-alpha) "." counter(thm) "."}
section.appendix proposition:not([data-labeled])::before{content: "Proposition " counter(app, upper-alpha) "." counter(thm) "."}

section.sec definition{counter-increment: def}
section.sec definition:not([data-labeled])::before{
  content: "Definition " counter(sec) "." counter(def) ".";
  display:block; font-weight:600; margin-bottom:6px
}
section.sec remark{counter-increment: rem}
section.sec remark:not([data-labeled])::before{
  content: "Remark " counter(sec) "." counter(rem) ".";
  display:block; font-style:italic; margin-bottom:6px
}

section.appendix definition{counter-increment: def}
section.appendix definition:not([data-labeled])::before{
  content: "Definition " counter(app, upper-alpha) "." counter(def) ".";
  display:block; font-weight:600; margin-bottom:6px
}
section.appendix remark{counter-increment: rem}
section.appendix remark:not([data-labeled])::before{
  content: "Remark " counter(app, upper-alpha) "." counter(rem) ".";
  display:block; font-style:italic; margin-bottom:6px
}

/* Footer */
theorem > footer,
definition > footer
{margin-top:8px; padding-top:8px; border-top:1px dashed var(--rule); font-size: 0.84rem}

/* Examples */
details.example{margin-top:8px; padding-top:8px; border-top:1px dashed var(--rule)}
details.example > summary{list-style:none; cursor:pointer; font-style:italic; font-weight:600; color:var(--muted)}
details.example > summary::-webkit-details-marker{display:none}
details.example > summary:empty::before{content:"Example."}
details.example p{font-style: normal}

/* Proofs */
details.proof{margin-top:8px; padding-top:8px; border-top:1px dashed var(--rule)}
details.proof > summary{list-style:none; cursor:pointer; font-style:italic; font-weight:600; color:var(--muted)}
details.proof > summary::-webkit-details-marker{display:none}
details.proof > summary:empty::before{content:"Proof."}
details.proof p{font-style: normal}
details.proof > p:last-of-type::after, details.proof > div p:last-of-type::after{content:"□"; float:right}

proof{display:block; margin:12px 0 14px 1.25em}
proof::before{content:"Proof."; font-style:italic; margin-right:.35em}
proof p{margin: .6em 0; font-style: normal}
proof p:last-of-type::after{content:"□"; float:right}

/* Figures & Tables (fallback prefixes only) */
figure{margin:16px 0; text-align:center}
section.sec figure{counter-increment: fig}
section.appendix figure{counter-increment: fig}
section.sec figure > figcaption:not([data-labeled])::before{
  content:"Figure " counter(sec) "." counter(fig) ". "; font-weight:600
}
section.appendix figure > figcaption:not([data-labeled])::before{
  content:"Figure " counter(app, upper-alpha) "." counter(fig) ". "; font-weight:600
}

table{width:100%; border-collapse:collapse; margin:14px 0}
th,td{border:1px solid var(--rule); padding:6px 8px}
section.sec table{counter-increment: tab}
section.appendix table{counter-increment: tab}
section.sec table > caption:not([data-labeled])::before{
  content:"Table " counter(sec) "." counter(tab) ". "; font-weight:600
}
section.appendix table > caption:not([data-labeled])::before{
  content:"Table " counter(app, upper-alpha) "." counter(tab) ". "; font-weight:600
}
section strong {font-weight: 600}

/* Inserted label nodes */
.block-title{font-weight:600; font-size: 1.14rem; margin-bottom:6px}
.block-subtitle{font-weight:500; font-size: 1.06rem; font-style: italic}
.secno, .ftno{font-weight:700}
